# 🎵 Arcaea Online Helper

一个功能强大的 Chrome 扩展，用于增强 Arcaea Online 查分页面体验，提供谱面定数显示、PTT 计算、推分辅助等多项实用功能。
**目前定数表适用于 移动版 v6.11.0。**

---

## ✨ 功能特点

### 📊 核心功能
- 🎯 **谱面定数显示** - 在曲目名称旁显示定数，如 `Tempestissimo (11.3)`
- 💎 **单曲 PTT 计算** - 实时计算并显示每首歌的 Potential
- 🎓 **精确总 PTT** - 基于 Best 30 和 Recent 10 计算准确的总 PTT 值
- 🎯 **推分目标提示** - 显示使显示 PTT +0.01 所需的目标分数
- 📈 **定数需求卡片** - 展示达到 +0.01 PTT 所需的最低谱面定数（EX+、EX、995W 等）
- 🔢 **曲目编号** - 自动为 Best 30 (#1-#30) 和 Recent 10 (R1-R10) 添加序号
- 📍 **分隔线** - 在 Best 30 和 Recent 10 之间添加视觉分隔
- 🖥️ **优化PC端排版和UI** - 针对桌面浏览器优化布局，提升查分页面的可读性和美观度

### 🎮 兼容性
- ✅ **支持所有难度** - Past / Present / Future / Beyond / Eternal
- 🔄 **动态更新** - 自动处理页面路由变化和动态加载
- 🌍 **多语言支持** - 支持英文和日文曲目名称
- 🎨 **自定义设置** - 可选择显示/隐藏图表、下载按钮等

### ⚡ 技术特性
- 🚀 **性能优化** - 不影响网站性能
- 🔒 **隐私安全** - 完全本地运行，不收集任何数据
- 🛡️ **稳定可靠** - 支持页面刷新和 SPA 路由切换

---

## 🚀 快速开始

### 前置要求

⚠️ **重要：需要用户订阅了 Arcaea Online**

本扩展仅适用于已订阅 Arcaea Online 服务的用户。如果您还未订阅，请访问 [Arcaea 官网](https://arcaea.lowiro.com/) 进行订阅。

### 安装（30秒）

1. 打开 Chrome，访问 `chrome://extensions/`
2. 开启「开发者模式」
3. 点击「加载已解压的扩展程序」
4. 选择本项目文件夹
5. 完成！

### 使用

1. 访问 https://arcaea.lowiro.com/
2. 登录账号
3. 进入 Profile 页面（Potential 页面）
4. 扩展会自动显示：
   - 谱面定数（灰色）
   - 单曲 PTT（紫色粗体）
   - 推分目标分数（绿色）
   - 总 PTT（用户名旁）
   - 定数需求卡片（B1 前方）

### ⚙️ 设置

点击扩展图标打开设置面板，可以自定义：

- **显示图表** - 是否显示 Best 30/Recent 10 的 PTT 变化图表（默认隐藏）
- **显示定数** - 是否显示谱面定数（默认显示）
- **显示单曲 PTT** - 是否显示单曲 PTT 值（默认显示）
- **显示目标分数** - 是否显示推分目标（默认显示）
- **显示下载按钮** - 是否显示截图下载和背景选择按钮（默认显示）

💡 **提示：** 更改设置后需刷新页面生效。


## 📸 效果预览

**Best 30 示例：**
```
╔═══════════════════════════════════════════════════╗
║  #1  Tempestissimo (11.3) 12.9876         ▸      ║
║      Score: 9,950,000  >> 9,965,432              ║
║                                                   ║
║  #2  Grievous Lady (11.1) 12.7543          ▸     ║
║      Score: 9,920,000  >> 9,948,765              ║
║                                                   ║
║  ... (更多曲目)                                   ║
║                                                   ║
║  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ ║
║                                                   ║
║  R1  Fracture Ray (11.1) 12.5432           ▸     ║
║      Score: 9,880,000  >> 9,912,345              ║
╚═══════════════════════════════════════════════════╝
```

**显示内容说明：**
- 曲目序号（#1-#30 为 Best 30，R1-R10 为 Recent 10）
- 曲目名称 + 谱面定数（灰色）
- 单曲 PTT 值（紫色粗体）
- 当前分数
- 目标分数（绿色，推分 +0.01 PTT 所需）
- 用户名旁显示计算的总 PTT

**定数需求卡片：**
```
╔═══════════════════════════════════════════════════╗
║  使显示 PTT +0.01 所需最低谱面定数                ║
║  当前显示: 12.50 → 目标: 12.51                    ║
╠═══════════════════════════════════════════════════╣
║  995W  │ EX+   │  EX   │ 970W  │ 960W  │  AA    ║
║  11.5  │ 11.8  │ 12.3  │ 12.6  │ 13.0  │ 13.3   ║
╚═══════════════════════════════════════════════════╝
```

---

## 🛠️ 技术栈

- **JavaScript (ES6+)** - 现代化的开发方式
- **Chrome Extension Manifest V3** - 最新的扩展标准
- **MutationObserver API** - 监听页面变化
- **JSON数据存储** - 轻量级数据管理


---

## ❓ 常见问题

<details>
<summary><strong>Q1: 定数/PTT 没有显示怎么办？</strong></summary>

1. 刷新页面（Cmd+R / Ctrl+R）
2. 检查是否在正确的页面（profile/potential）
3. 打开控制台（F12）查看是否有错误
4. 检查扩展设置，确认相关选项已启用
5. 等待几秒钟让扩展初始化完成
</details>

<details>
<summary><strong>Q2: 扩展安全吗？</strong></summary>

完全安全！扩展：
- ✅ 不访问个人数据
- ✅ 不发送网络请求
- ✅ 只在 arcaea.lowiro.com 运行
- ✅ 完全开源，代码可审查
</details>

<details>
<summary><strong>Q3: 支持哪些浏览器？</strong></summary>

- ✅ Chrome（推荐）
- ✅ Microsoft Edge
- ✅ Brave
- ✅ 其他 Chromium 内核浏览器
- ❌ Firefox or Safari
</details>

<details>
<summary><strong>Q4: 如何更新定数和曲目列表数据？</strong></summary>

当 Arcaea 有新曲目或定数变化时，需要手动更新 JSON 数据文件：

**更新步骤：**

1. **获取最新数据** - 访问 Arcaea 中文维基获取最新 JSON 数据：
   - [ChartConstant.json](https://arcwiki.mcd.blue/index.php?title=Template:ChartConstant.json&action=edit) - 谱面定数数据
   - [Songlist.json](https://arcwiki.mcd.blue/index.php?title=Template:Songlist.json&action=edit) - 曲目列表数据

2. **复制代码** - 在上述页面中复制完整的 JSON 代码

3. **替换本地文件** - 用复制的内容分别替换扩展文件夹中的：
   - `ChartConstant.json`
   - `Songlist.json`

4. **重载扩展** - 在 `chrome://extensions/` 页面点击扩展的刷新按钮

5. **刷新网页** - 重新加载 Arcaea Online 页面即可生效

**注意：**
- 本仓库会尽量同步更新数据文件，但不保证始终为最新版本
- 建议在 Arcaea 更新后手动检查并更新数据文件
- 数据来源于 Arcaea 中文维基社区，感谢数据维护者的贡献
</details>

<details>
<summary><strong>Q5: 为什么有些曲目定数显示不出来？</strong></summary>

可能原因：
- 曲目名称在数据库中不存在
- 该难度没有定数（某些曲目不是所有难度都有）
- 曲目名称匹配失败（可查看控制台警告）
</details>

<details>
<summary><strong>Q6: 计算的总 PTT 和官方显示不一致？</strong></summary>

这是正常的！扩展显示的是**精确计算值**（保留 4 位小数），而官方显示的是**向下取整到两位小数**的值。

例如：
- 扩展显示：12.5089
- 官方显示：12.50

扩展计算更精确，可以帮助你更好地了解推分进度。
</details>

<details>
<summary><strong>Q7: 目标分数是如何计算的？</strong></summary>

目标分数（绿色 `>>` 后的数字）是使你的**显示 PTT +0.01** 所需的最低分数。

计算考虑了：
- 当前总 PTT
- 当前这首歌的单曲 PTT
- 谱面定数
- PTT 显示规则（向下取整到两位小数）

如果显示「无法推分」，说明即使打到 PM（满分）也无法让显示 PTT +0.01。
</details>

<details>
<summary><strong>Q8: 定数需求卡片怎么看？</strong></summary>

卡片显示不同分数等级下，使显示 PTT +0.01 所需的**最低谱面定数**。

例如：
- **995W**：打到 9,950,000+ 分时，需要 11.5 定数的谱面
- **EX+**：打到 EX+ (9,900,000+) 时，需要 11.8 定数
- **EX**：打到 EX (9,800,000+) 时，需要 12.3 定数

这可以帮助你规划推分策略：选择合适难度的谱面，用合适的分数来推分。
</details>

---

## 🔧 故障排除

### 扩展无法加载
```bash
# 检查清单：
□ 确认「开发者模式」已开启
□ 检查 manifest.json 是否存在且格式正确
□ 确认所有必需文件都在文件夹中
□ 查看扩展页面的具体错误提示
```

### 定数显示异常
```bash
# 调试步骤：
1. 打开控制台（F12）
2. 查看是否有红色错误信息
3. 运行 test.js 进行诊断
4. 检查网络请求是否正常
```


---

## 🎯 已实现功能

- [x] 谱面定数显示
- [x] 单曲 PTT 计算和显示
- [x] 总 PTT 精确计算
- [x] 推分目标分数提示
- [x] 定数需求分析卡片
- [x] Best 30 和 Recent 10 编号
- [x] 设置页面（图表显示、下载按钮等）
- [x] 支持页面路由切换
- [x] 多语言曲目名称支持


## 📄 许可

本项目仅供学习和个人使用。

**注意事项：**
- Arcaea 是 lowiro 的注册商标
- 定数数据来源于公开资料
- 请勿用于商业用途

---

## 🙏 致谢

- Arcaea 开发团队 lowiro
- 社区数据贡献者
- 所有 Arcaea 玩家

---


**享受你的 Arcaea 之旅！** 🎵✨
