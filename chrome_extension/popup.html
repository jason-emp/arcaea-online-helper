<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Arcaea Helper 设置</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Material+Symbols+Rounded" rel="stylesheet">
  <style>
    :root {
      color-scheme: light;
      --md-sys-color-primary: #6750a4;
      --md-sys-color-on-primary: #ffffff;
      --md-sys-color-surface: #fffbfe;
      --md-sys-color-surface-container: #f7f2fa;
      --md-sys-color-outline: #7a7289;
      --md-sys-color-on-surface: #1c1b1f;
      --md-sys-color-on-surface-variant: #49454f;
      --md-sys-color-tertiary: #7d5260;
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-width: 360px;
      max-width: 420px;
      padding: 0;
      background: radial-gradient(circle at top, rgba(103, 80, 164, 0.18), transparent 60%),
        radial-gradient(circle at bottom, rgba(125, 82, 96, 0.12), transparent 55%),
        #ece6f0;
      color: var(--md-sys-color-on-surface);
    }

    .md-app {
      padding: 16px;
    }

    .md-surface {
      background: var(--md-sys-color-surface);
      border-radius: 20px;
      box-shadow: 0 1px 3px rgba(28, 27, 31, 0.18), 0 4px 12px rgba(28, 27, 31, 0.08);
      padding: 18px 20px 20px;
      border: 1px solid rgba(103, 80, 164, 0.08);
    }

    .md-top-app-bar {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .md-app-icon {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      background: linear-gradient(135deg, #6750a4, #7d5260);
      color: var(--md-sys-color-on-primary);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .md-top-app-bar h1 {
      font-size: 18px;
      font-weight: 600;
      color: var(--md-sys-color-on-surface);
      letter-spacing: 0.02em;
    }

    .md-subtitle {
      font-size: 13px;
      color: var(--md-sys-color-on-surface-variant);
      margin-top: 2px;
    }

    .md-section-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--md-sys-color-on-surface-variant);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin: 16px 0 8px;
    }

    .md-card {
      border-radius: 16px;
      background: var(--md-sys-color-surface-container);
      padding: 4px 0;
      border: 1px solid rgba(28, 27, 31, 0.08);
    }

    .md-setting-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      gap: 16px;
      transition: background-color 0.2s ease;
    }

    .md-setting-row + .md-setting-row {
      border-top: 1px solid rgba(28, 27, 31, 0.06);
    }

    .md-setting-row:focus-within,
    .md-setting-row:hover {
      background: rgba(103, 80, 164, 0.08);
    }

    .md-setting-text {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .md-setting-text strong {
      font-size: 14px;
      font-weight: 600;
      color: var(--md-sys-color-on-surface);
    }

    .md-setting-text span {
      font-size: 12px;
      color: var(--md-sys-color-on-surface-variant);
      line-height: 1.4;
    }

    .md-switch {
      position: relative;
      display: inline-flex;
      width: 52px;
      height: 32px;
      align-items: center;
      justify-content: center;
    }

    .md-switch input {
      position: absolute;
      opacity: 0;
      width: 100%;
      height: 100%;
      cursor: pointer;
      margin: 0;
    }

    .md-switch-track {
      width: 36px;
      height: 16px;
      border-radius: 16px;
      background: rgba(28, 27, 31, 0.28);
      position: relative;
      transition: background 0.25s ease;
    }

    .md-switch-thumb {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: var(--md-sys-color-surface);
      position: absolute;
      top: 50%;
      left: -6px;
      transform: translateY(-50%);
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.24);
      border: 1px solid rgba(28, 27, 31, 0.15);
      transition: left 0.25s ease, background 0.25s ease, border 0.25s ease;
    }

    .md-switch input:checked + .md-switch-track {
      background: rgba(103, 80, 164, 0.35);
    }

    .md-switch input:checked + .md-switch-track .md-switch-thumb {
      left: 14px;
      background: var(--md-sys-color-primary);
      border-color: transparent;
      color: var(--md-sys-color-on-primary);
    }

    .md-switch input:focus-visible + .md-switch-track {
      outline: 2px solid var(--md-sys-color-primary);
      outline-offset: 4px;
    }

    .md-support-card {
      margin-top: 16px;
      padding: 14px 16px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(103, 80, 164, 0.08), rgba(125, 82, 96, 0.1));
      border: 1px solid rgba(103, 80, 164, 0.1);
    }

    .md-support-card p {
      font-size: 12px;
      color: var(--md-sys-color-on-surface-variant);
      line-height: 1.4;
    }

    .md-support-card strong {
      color: var(--md-sys-color-primary);
    }

    .md-footer {
      margin-top: 16px;
      text-align: center;
    }

    .md-footer p {
      font-size: 11px;
      color: var(--md-sys-color-on-surface-variant);
      line-height: 1.4;
    }

    .md-snackbar {
      position: fixed;
      left: 50%;
      bottom: 16px;
      transform: translate(-50%, 150%);
      min-width: 220px;
      max-width: 320px;
      color: white;
      padding: 12px 16px;
      border-radius: 24px;
      font-size: 13px;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.24);
      transition: transform 0.3s ease, opacity 0.3s ease;
      opacity: 0;
      z-index: 2;
    }

    .md-snackbar.success {
      background: #312f33;
    }

    .md-snackbar.error {
      background: #b3261e;
    }

    .md-snackbar.show {
      transform: translate(-50%, 0);
      opacity: 1;
    }

    .material-symbols-rounded {
      font-family: 'Material Symbols Rounded';
      font-weight: normal;
      font-style: normal;
      font-size: 18px;
      display: inline-flex;
      vertical-align: middle;
    }

    .md-update-section {
      margin-top: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .md-update-button {
      width: 100%;
      padding: 12px 20px;
      border: none;
      border-radius: 20px;
      background: linear-gradient(135deg, var(--md-sys-color-primary), var(--md-sys-color-tertiary));
      color: var(--md-sys-color-on-primary);
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 2px 8px rgba(103, 80, 164, 0.2);
    }

    .md-update-button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(103, 80, 164, 0.3);
    }

    .md-update-button:active {
      transform: translateY(0);
      box-shadow: 0 2px 8px rgba(103, 80, 164, 0.2);
    }

    .md-update-button .material-symbols-rounded {
      font-size: 20px;
    }

    .md-update-description {
      font-size: 12px;
      color: var(--md-sys-color-on-surface-variant);
      text-align: center;
      line-height: 1.4;
    }
  </style>
</head>
<body>
  <div class="md-app">
    <div class="md-surface" role="region" aria-label="Arcaea Helper 设置">
      <header class="md-top-app-bar">
        <div class="md-app-icon">
          <span class="material-symbols-rounded" aria-hidden="true">graphic_eq</span>
        </div>
        <div>
          <h1>Arcaea Helper</h1>
          <p class="md-subtitle">个性化你的浏览体验</p>
        </div>
      </header>

      <p class="md-section-title">显示设置</p>
      <section class="md-card" aria-label="显示设置">
        <div class="md-setting-row">
          <div class="md-setting-text">
            <strong>显示图表</strong>
            <span>展示 Best 30 / Recent 10 的 PTT 变化曲线</span>
          </div>
          <label class="md-switch">
            <input type="checkbox" id="showCharts">
            <span class="md-switch-track" aria-hidden="true">
              <span class="md-switch-thumb"></span>
            </span>
          </label>
        </div>

        <div class="md-setting-row">
          <div class="md-setting-text">
            <strong>显示定数</strong>
            <span>在曲目名称旁同步显示谱面定数</span>
          </div>
          <label class="md-switch">
            <input type="checkbox" id="showConstant" checked>
            <span class="md-switch-track" aria-hidden="true">
              <span class="md-switch-thumb"></span>
            </span>
          </label>
        </div>

        <div class="md-setting-row">
          <div class="md-setting-text">
            <strong>显示单曲 PTT</strong>
            <span>在曲目列表中标注当前成绩对应的 PTT</span>
          </div>
          <label class="md-switch">
            <input type="checkbox" id="showPTT" checked>
            <span class="md-switch-track" aria-hidden="true">
              <span class="md-switch-thumb"></span>
            </span>
          </label>
        </div>
      </section>

      <p class="md-section-title">辅助工具</p>
      <section class="md-card" aria-label="辅助工具设置">
        <div class="md-setting-row">
          <div class="md-setting-text">
            <strong>显示目标分数</strong>
            <span>给出提升 0.01 PTT 所需的目标分数提示</span>
          </div>
          <label class="md-switch">
            <input type="checkbox" id="showTargetScore" checked>
            <span class="md-switch-track" aria-hidden="true">
              <span class="md-switch-thumb"></span>
            </span>
          </label>
        </div>

        <div class="md-setting-row">
          <div class="md-setting-text">
            <strong>显示下载按钮</strong>
            <span>保留截图下载与背景选择控制</span>
          </div>
          <label class="md-switch">
            <input type="checkbox" id="showDownloadButtons" checked>
            <span class="md-switch-track" aria-hidden="true">
              <span class="md-switch-thumb"></span>
            </span>
          </label>
        </div>
      </section>

      <div class="md-support-card">
        <p>
          设置将立即保存在 <strong>chrome.storage.sync</strong> 中，刷新 Arcaea 页面即可生效。
          如果某个开关无响应,请确认页面已安装最新版本扩展。
        </p>
      </div>

      <div class="md-update-section">
        <button class="md-update-button" id="checkUpdateButton">
          <span class="material-symbols-rounded" aria-hidden="true">download</span>
          <span>检查更新</span>
        </button>
        <p class="md-update-description">跳转至 GitHub 发布页下载最新版本</p>
      </div>

      <footer class="md-footer">
        <p>提示：刷新页面后最新设置才会同步到网页</p>
      </footer>
    </div>
  </div>

  <div class="md-snackbar success" id="statusMessage" role="status" aria-live="polite">
    <span class="material-symbols-rounded" aria-hidden="true" data-snackbar-icon>check_circle</span>
    <span data-snackbar-text>设置已保存</span>
  </div>

  <script src="popup.js"></script>
</body>
</html>
